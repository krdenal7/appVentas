<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title></title>
<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
<link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.4.5.min.css">
<link rel="stylesheet" type="text/css" href="css/marzamcss.css"/>
<link rel="stylesheet" type="text/css" href="css/jquery.mobile.icons.min.css">
<link rel="stylesheet" href="css/jquery-ui.css" >
<script src="js/jquery.js"></script>
<script src="js/jquery.mobile-1.4.4.js"></script>
<script src="js/jquery-ui.js"></script>
<script src="js/highcharts.js"></script>
<script src="js/phonegap.js" type="text/javascript"></script>
<script>

     function GetValores(){
// capturamos la url
        var loc = document.location.href;
        //alert(loc);
        // si existe el interrogante
        if(loc.indexOf('?')>0)
        {
            // cogemos la parte de la url que hay despues del interrogante
            var getString = loc.split('?')[1];
            // obtenemos un array con cada clave=valor
            var GET = getString.split('&');
            var get = {};


            // recorremos todo el array de valores
            for(var i = 0, l = GET.length; i < l; i++){
                var tmp = GET[i].split('=');
                get[tmp[0]] = unescape(decodeURI(tmp[1]));
            }

            return get;
        }

     }

    $(function () {

        var valores=GetValores();
		
		var saldo;
		var limite;
		var saldo;
		var limite;
		var nombre1;
		var d30;
		var nombre2;
		var d60;
		var nombre3;
		var d90;
		var nombre4;
		var dmas;
		
		
		
		 for(var index in valores)
            {
			        if(index=="A")
			        saldo=valores[index];
					
					if(index=="B")
					limite=valores[index];
					
					if(index=="C")
					nombre1=valores[index];
			        if(index=="D")
			        d30=valores[index];
					
					if(index=="E")
					nombre2=valores[index];
					if(index=="F")
			        d60=valores[index];
					
					if(index=="G")
					nombre3=valores[index];
					 if(index=="H")
			        d90=valores[index];
					
					if(index=="I")
					nombre4=valores[index];
					if(index=="J")
			        dmas=valores[index];
					
					
			   
		 }
		 
		 var signo1="";
		 var signo2="";
		 
		 if (saldo.indexOf("-") >= 0)
			signo1="-";
			
		 if (limite.indexOf("-") >= 0)
			 signo2="-";
			 

		 saldo = deci(saldo);
		 limite = deci(limite);

	    var d302=parseFloat(d30==null?0:d30);
		var d602=parseFloat(d60==null?0:d60);
		var d902=parseFloat(d90==null?0:d90);
		var dmas2=parseFloat(dmas==null?0:dmas);
		
		
        var disponible=2500.00,D30=d302,D60=d602,D90=d902,MD90=dmas2;
		var n1=nombre1==null?"--":nombre1;
		var n2=nombre2==null?"--":nombre2;
		var n3=nombre3==null?"--":nombre3;
		var n4=nombre4==null?"--":nombre4;
		
		var v1=nombre1==null?false:true;
		var v2=nombre2==null?false:true;
		var v3=nombre3==null?false:true;
		var v4=nombre4==null?false:true;
		
		

		
	 $('#inf').empty();

	 $( "#progressbar").progressbar({
			value:(140*100)/1000
			});

	 $('#inf').append('<span>Saldo:&nbsp;</span> <span id="saldo">$'+signo1+saldo+'</span> <br/>' +
        '<span>Límite:</span> <span id="limite">$'+signo2+limite+'</span><div id="progressbar" style="width:100%; height:15px; margin:0px auto;"></div>');

    $('#container').highcharts({
        chart: {
            type: 'bar',height:'300'
        },
        title: {
            text: 'Gráfica'
        },
        xAxis: {
            categories: ['Total'],
            title: {
                text: null
            },
            height: '100',
            lineColor: '#FFFFFF',
            labels: {
                formatter: function () {
                    return '<span style="fill: white;">' + this.value + '</span>';
                }
            }
        },
        yAxis: {
            min: 0,
            title: {
                text: '',
                align: 'high'
            },
            height: '100',
            labels: {
                formatter: function () {
                    return '<span style="fill: white;">' + this.value + '</span>';
                }
            }
        },
        tooltip: {
            valueSuffix: ''
        },       
        credits: {
            enabled: false
        },
        series: [
		{
			name: n1+deci(D30.toString()),data: [D30],
			visible:v1		
			
		},
		{
			name: n2+deci(D60.toString()),data: [D60],
			visible:v2
		},
		{
			name: n3+deci(D90.toString()),data: [D90],
			visible:v3
		},
		{
			name: n4+deci(MD90.toString()),data: [MD90],
			visible:v4
		}
		
		
		]
    });
});

function deci(valor){
            var dec=valor.split(".");
            var leng = parseInt((dec).length);
            var cantidad="";
            if(leng==2){
            cantidad=conComas(dec[0],dec[1]);
    }else{
            cantidad=conComas(dec[0],"00");
            }
            return cantidad;
            }
function conComas(valor,Deci) {
            
    var nums = new Array();
    var simb = ","; //Éste es el separador
    valor = valor.toString();
    valor = valor.replace(/\D/g, "");   //Ésta expresión regular solo permitira ingresar números
    nums = valor.split(""); //Se vacia el valor en un arreglo
    var long = nums.length - 1; // Se saca la longitud del arreglo
    var patron = 3; //Indica cada cuanto se ponen las comas
    var prox = 2; // Indica en que lugar se debe insertar la siguiente coma
    var res = "";
 
    while (long > prox) {
        nums.splice((long - prox),0,simb); //Se agrega la coma
        prox += patron; //Se incrementa la posición próxima para colocar la coma
    }
 
    for (var i = 0; i <= nums.length-1; i++) {
        res += nums[i]; //Se crea la nueva cadena para devolver el valor formateado
    }
 
    return res+"."+Deci;
}
</script>
<script>

    $(document).ready(function(){

           

    });



</script>


</head>
<body class="ui-mobile-viewport ui-overlay-a" >
<div data-role="page" id="Ventas" data-title="Ventas" data-url="panel-fixed-page1" tabindex="0">
  <div class="ui-panel-wrapper">
    <div role="main" class="ui-content jqm-content jqm-fullwidth">
      <div id="inf" style="width:90%; margin:0px auto; font-size:20px; color:#fff;" ><span>Saldo:</span> <span id="saldo">$91,038.00</span> <br/>
        <span>Límite:</span> <span id="limite">$288,630.00</span>
        <div id="progressbar" style="width:100%; height:15px; margin:0px auto;"></div>
      </div>
        </br>
      <div id="graficas">
        <div id="container" style="min-width: 80%; max-width: 80%; height: 20%;"></div>
      </div>
    </div>
    <!--main--> 
  </div>
  <!-- /content -->
  
 <!-- <div data-role="footer" data-position="fixed" role="contentinfo" class="ui-footer ui-bar-inherit ui-footer-fixed slideup ui-fixed-hidden">
    <h4 class="ui-title" role="heading" aria-level="1">Casa Marzam S.A de C.V. &copy;</h4>
  </div>
  <!-- /footer -->
  
  <div data-role="panel" data-position-fixed="true" data-display="push" data-theme="b" id="nav-panel" class="ui-panel ui-panel-position-left ui-panel-display-push ui-panel-closed ui-body-b ui-panel-fixed ui-panel-animate">
    <div class="ui-panel-inner">
      <ul data-role="listview" class="ui-listview">
        <li data-icon="delete" class="ui-first-child"><a href="#" data-rel="close" class="ui-btn ui-btn-icon-right ui-icon-delete">Menú</a></li>
      </ul>
    </div>
  </div>
  <!-- /panel -->
  
  <div data-role="panel" data-position="right" data-position-fixed="true" data-display="overlay" data-theme="a" id="add-form" class="ui-panel ui-panel-position-right ui-panel-display-overlay ui-panel-closed ui-body-a ui-panel-fixed ui-panel-animate">
    <div class="ui-panel-inner">
      <form class="userform">
        <h2>Login</h2>
        <label for="name">Username:</label>
        <div class="ui-input-text ui-body-inherit ui-corner-all ui-mini ui-shadow-inset ui-input-has-clear">
          <input type="text" name="name" id="name" value="" data-clear-btn="true" data-mini="true">
          <a href="#" tabindex="-1" aria-hidden="true" class="ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all ui-input-clear-hidden" title="Clear text">Clear text</a></div>
        <label for="password">Password:</label>
        <div class="ui-input-text ui-body-inherit ui-corner-all ui-mini ui-shadow-inset ui-input-has-clear">
          <input type="password" name="password" id="password" value="" data-clear-btn="true" autocomplete="off" data-mini="true">
          <a href="#" tabindex="-1" aria-hidden="true" class="ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all ui-input-clear-hidden" title="Clear text">Clear text</a></div>
        <div class="ui-grid-a">
          <div class="ui-block-a"><a href="#" data-rel="close" class="ui-btn ui-shadow ui-corner-all ui-btn-b ui-mini">Cancel</a></div>
          <div class="ui-block-b"><a href="#" data-rel="close" class="ui-btn ui-shadow ui-corner-all ui-btn-a ui-mini">Save</a></div>
        </div>
      </form>
    </div>
  </div>
  <!-- /panel --> 
  
</div>
<!-- /page -->

<div data-role="page" id="panel-fixed-page2" data-url="panel-fixed-page2">
  <div data-role="header">
    <h1>Landing page</h1>
  </div>
  <!-- /header -->
  
  <div role="main" class="ui-content jqm-content"> </div>
  <!-- /content --> 
  
</div>
<!-- /page -->

<div class="ui-loader ui-corner-all ui-body-a ui-loader-default"><span class="ui-icon-loading"></span>
  <h1>loading</h1>
</div>
<div class="ui-panel-dismiss"></div>
<div class="ui-panel-dismiss"></div>
<script>
  function GetValores(){
// capturamos la url
        var loc = document.location.href;
        //alert(loc);
        // si existe el interrogante
        if(loc.indexOf('?')>0)
        {
            // cogemos la parte de la url que hay despues del interrogante
            var getString = loc.split('?')[1];
            // obtenemos un array con cada clave=valor
            var GET = getString.split('&');
            var get = {};


            // recorremos todo el array de valores
            for(var i = 0, l = GET.length; i < l; i++){
                var tmp = GET[i].split('=');
                get[tmp[0]] = unescape(decodeURI(tmp[1]));
            }

            return get;
        }

     }

 	$(function() {

 	    var valores=GetValores();
 	    var saldo;
 	    var limite;

 	     for(var index in valores)
            {
			        if(index=="A")
			        saldo=valores[index];
					if(index=="B")
					limite=valores[index];
			}


		var val1=parseFloat(saldo);
		var val2=parseFloat(limite);

		$( "#progressbar").progressbar({
			value:(val1*100)/val2
			});
		});
 </script>
</body>
</html>
